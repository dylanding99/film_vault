# FilmVault 开发路线图

## 当前版本：v0.3.0 (2026-02-08) ✅ 已完成

### v0.3.0 已完成功能 ✅

**EXIF 模块**：
- ✅ ExifInfoPanel 组件 - 显示照片 EXIF 信息（ISO、光圈、快门、焦距、GPS）
- ✅ PhotoMetadataForm 组件 - 编辑单张照片的拍摄参数
- ✅ EXIF 信息显示在照片预览对话框
- ✅ 从文件读取 EXIF 数据功能
- ✅ 保存 EXIF 到文件功能
- ✅ EXIF 同步状态和写入时间追踪
- ✅ 混合架构：胶卷元数据保留在数据库，照片 EXIF 从文件读取

**筛选与搜索功能**：
- ✅ RollFilters 组件 - 按胶卷型号、相机筛选
- ✅ 搜索框 - 按胶卷名称、备注搜索
- ✅ 收藏筛选（只看有收藏的胶卷）
- ✅ URL 参数同步 - 支持分享筛选链接
- ✅ 刷新页面后筛选条件持久化

**设置页面增强**：
- ✅ EXIF 设置面板 - ExifTool 状态显示
- ✅ 自动写入 EXIF 开关
- ✅ 并发写入数设置（1-8）
- ✅ 设置路径使用 React Query 管理
- ✅ 完整中文化界面

**数据库优化**：
- ✅ 迁移 004 - EXIF 写入追踪和照片级 EXIF 字段
- ✅ 迁移 005 - EXIF 和 UI 设置字段
- ✅ 迁移 006 - 移除照片级 EXIF 列（混合架构）

**Bug 修复**：
- ✅ 修复封面按钮状态更新问题
- ✅ 修复删除封面后自动设置新封面
- ✅ 修复设置路径保存后刷新显示问题
- ✅ 修复胶卷详情页 SQL 查询错误（get_roll_cover）
- ✅ 移除海拔 EXIF 字段
- ✅ 移除网格列数调整功能

---

## 上一版本：v0.2.1 (2026-02-07)

### 已完成功能 ✅

**核心功能**：
- ✅ 胶卷导入功能（支持 JPG、PNG、WebP 等格式）
- ✅ 自动缩略图生成（300px WebP）
- ✅ 自动预览图生成（1920px WebP）
- ✅ 胶卷列表展示（卡片式布局）
- ✅ 多胶卷管理（自动路径冲突处理）

**编辑功能**：
- ✅ 元数据编辑（名称、胶卷型号、相机、镜头、日期、备注）
- ✅ 数据持久化（SQLite 数据库）
- ✅ 错误处理（空文件夹提示、路径冲突处理）

**技术实现**：
- ✅ Next.js 15 + Tauri v2 混合架构
- ✅ React Query 数据缓存管理
- ✅ Rust + SQLx SQLite 数据库
- ✅ Base64 图片显示方案
- ✅ 自动路径冲突检测和处理

### 已修复问题 ✅
- ✅ 元数据编辑缓存刷新问题（使用 refetchQueries）
- ✅ 导入第二个胶卷失败（路径冲突自动处理）
- ✅ 导入胶卷后不自动显示（缓存刷新优化）
- ✅ 编辑元数据保存失败（UPDATE 语句优化）

### v0.2.1 已完成 ✅
- ✅ 删除功能简化（移除多选项，统一删除逻辑）
- ✅ 缓存刷新优化（使用 `setQueryData` 立即更新）
- ✅ 删除后不再尝试加载已删除文件
- ✅ 修复详情页删除胶卷后的导航问题

### 测试状态 ✅
- ✅ 阶段一测试完成（94.9% 通过率）
- ✅ 37/39 测试项通过
- ✅ 4 个问题全部修复

---

## 当前版本：v0.2.0（已完成）

### 阶段二：核心功能完善
**优先级：高**

#### 1. 自定义存储位置 🌟
**用户明确需求**
- 允许用户自定义数据库和文件存储位置
- 添加配置文件（`config.json`）
- 首次运行时显示设置向导
- 支持修改现有存储位置（数据迁移功能）

**技术考虑**：
- 修改 `src-tauri/src/lib.rs` - 读取配置文件
- 修改 `src-tauri/src/commands/import.rs` - 使用配置的路径
- 修改 `src-tauri/src/database.rs` - 使用配置的数据库路径
- 添加设置界面组件

#### 2. 胶卷详情页面
- 点击胶卷卡片查看所有照片
- 网格/列表视图切换
- 照片全屏预览
- 批量选择操作

#### 3. 照片收藏功能
- 点亮照片红心

#### 4. 胶卷删除功能
- 删除胶卷记录和文件
- 确认对话框防止误删
- 软删除（可恢复）或永久删除选项
- 级联删除相关照片

#### 5. 改进导入体验
- 详细的导入进度条
- 实时显示处理的文件名
- 导入速度优化
- 重复导入提示和智能处理

---

## 未来版本规划

### v0.3.0 - 高级功能（中优先级）

#### ExifTool 集成
- 读取 EXIF 元数据（相机设置、拍摄参数）
- 自动填充元数据
- EXIF 数据展示界面

#### 地理位置编辑
- 为照片添加位置信息
- 经纬度坐标输入
- 位置搜索功能

#### 地图集成
- React-Leaflet + OpenStreetMap
- 照片位置可视化
- 地图上查看照片

#### 高级搜索和过滤
- 多条件搜索（日期、胶卷型号、相机、评分等）
- 保存搜索条件
- 智能筛选建议

#### 批量操作
- 批量编辑元数据
- 批量评分
- 批量导出
- 批量删除

---

### v0.4.0+ - 用户体验优化（低优先级）

#### 界面美化
- 暗色/亮色主题切换
- 自定义主题颜色
- 更多布局选项
- 动画效果优化

#### 交互优化
- 键盘快捷键支持
- 拖拽上传照片
- 右键菜单
- 快速操作面板

#### 导出功能
- 导出单个照片
- 导出整个胶卷
- 导出为压缩包
- 社交媒体分享（直接发布）

#### 性能优化
- 大量照片虚拟滚动
- 懒加载优化
- 数据库查询优化
- 缓存策略优化

---

## 技术债务和改进

### 代码质量
- [ ] 添加单元测试
- [ ] 添加集成测试
- [ ] 提高代码覆盖率
- [ ] 性能基准测试

### 文档完善
- [ ] API 文档
- [ ] 贡献者指南
- [ ] 用户手册
- [ ] 部署指南

### 开发工具
- [ ] CI/CD 流水线
- [ ] 自动化测试
- [ ] 代码格式化规范
- [ ] Lint 规则完善

---

## 版本时间线

| 版本 | 功能重点 | 发布时间 | 状态 |
|------|---------|---------|------|
| v0.1.0 | 核心导入功能 | 2026-02-06 | ✅ 完成 |
| v0.2.0 | 功能完善（存储、详情页、批量操作） | 2026-02-06 | ✅ 完成 |
| v0.2.1 | 删除功能简化 + Bug修复 | 2026-02-07 | ✅ 完成 |
| v0.3.0 | 高级功能（EXIF、筛选、设置） | 2026-02-08 | ✅ 完成 |
| v0.4.0+ | 体验优化 | 待定 | 📋 计划中 |

---

## 功能优先级说明

### 优先级判断标准

**高优先级**：
- 用户明确需求
- 影响核心工作流
- 阻碍基本使用

**中优先级**：
- 增强功能但不影响基本使用
- 提升效率但非必需
- 高级用户需要

**低优先级**：
- 锦上添花的功能
- 可替代的方案
- 长期改进项目

---

## 贡献指南

欢迎贡献！如果你有想法或建议，请：
1. 创建 Issue 讨论功能需求
2. Fork 项目并创建分支
3. 提交 Pull Request
4. 等待代码审查和合并

详见：[CONTRIBUTING.md](./CONTRIBUTING.md)（待创建）

---

**最后更新**: 2026-02-06
**维护者**: FilmVault 开发团队
