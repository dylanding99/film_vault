# FilmVault 测试文档

**测试版本**: v0.3.0
**测试开始时间**: _____________
**测试完成时间**: _____________

---

## 📋 测试环境信息

- **应用版本**: v0.3.0
- **操作系统**: Windows _____________
- **Node.js 版本**: _____________
- **Rust 版本**: _____________
- **测试数据库路径**: `%APPDATA%\com.filmvault.app\film_vault.db`

---

## ✅ 功能清单

### 核心功能
- [ ] 自定义存储位置
- [ ] 胶卷导入
- [ ] 胶卷列表展示
- [ ] 胶卷详情页
- [ ] 照片预览
- [ ] 元数据编辑

### v0.2.x 功能
- [ ] 删除功能（胶卷和照片）
- [ ] 收藏功能
- [ ] 完整中文化

### v0.3.0 新增功能 ⭐
- [ ] **EXIF 信息显示** - 查看照片拍摄参数
- [ ] **EXIF 编辑** - 编辑 ISO、光圈、快门、焦距
- [ ] **EXIF 从文件读取** - 从照片文件读取现有 EXIF
- [ ] **筛选与搜索** - 按胶卷型号、相机、日期范围筛选
- [ ] **URL 参数同步** - 筛选条件可通过 URL 分享
- [ ] **设置增强** - ExifTool 状态、自动写入开关、网格列数

---

## 🧪 测试用例

### 模块 1: 基础设置 ⚙️

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 启动应用 | 运行 `npm run tauri:dev` | 应用正常启动，界面显示正常 | ✅ 正常 |
| 界面显示 | 检查首页 UI | 显示 FilmVault 标题、导入按钮 | ✅ 正常 |
| 设置图库路径 | 点击设置图标 → 选择路径 → 保存 | 路径已保存，下次启动保持 | ✅ 已修复 |
| ExifTool 状态检查 | 打开设置对话框 | 显示 ExifTool 可用/不可用状态 | ✅ 正常 |

---

### 模块 2: 导入功能 📥

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 导入第一个胶卷（复制） | 选择文件夹 → 填写信息 → 选择"复制" → 导入 | 导入成功，对话框关闭，新胶卷显示 | 正常 |
| 导入进度显示 | 观察导入过程 | 进度条、计数、文件名实时更新 | 正常 |
| 导入后立即显示 | 导入完成后观察首页 | 新胶卷立即显示，无需刷新 | 正常 |
| 导入空文件夹 | 选择不含图片的文件夹 | 前端提示"未找到照片"，不导入 | 正常 |

---

### 模块 3: 胶卷列表 🎞️

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 胶卷卡片显示 | 查看首页 | 胶卷以卡片形式展示 | 正常 |
| 封面图显示 | 查看卡片图片 | 显示封面图或首张图 | 正常 |
| 照片数量统计 | 查看卡片统计 | 显示照片数量 | 正常 |

---

### 模块 4: 胶卷详情页 🖼️

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 进入详情页 | 点击胶卷卡片 | 跳转到详情页，显示所有照片 | 正常 |
| 照片网格显示 | 查看照片布局 | 响应式网格布局 | 正常 |
| 只显示收藏筛选 | 勾选"只显示收藏" | 只显示收藏的照片 | 正常 |

---

### 模块 5: 照片预览 👁️

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 打开预览 | 点击任意照片 | 全屏预览打开 | 正常 |
| 预览图质量 | 查看预览图 | 显示清晰预览图（1920px） | 正常 |
| 键盘切换 | 按键盘左右箭头 | 切换到上一张/下一张 | 正常 |
| 键盘退出 | 按 ESC 键 | 关闭预览 | 正常 |
| 循环导航 | 在第一张按左箭头，最后一张按右箭头 | 循环到另一端 | 正常 |

---

## 📷 v0.3.0 新功能测试 - EXIF 模块

**⚠️ 架构变更（2026-02-07）**：
- 已实施混合架构重构（体验优化005）
- **胶卷层级元数据**（相机、镜头、胶卷型号）：保留在数据库
- **照片层级EXIF**（ISO、光圈、快门、焦距）：直接从文件读取
- **优势**：无需手动同步，数据源单一，不会出现不一致
- **影响**：每次查看EXIF需要从文件读取（性能可接受），删除了海拔显示

---

### 模块 6: EXIF 信息显示 📊

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 打开 EXIF 面板 | 在照片预览中点击"EXIF 信息"按钮 | 左上角显示 EXIF 信息面板 | ✅ 正常 | |
| 无 EXIF 数据提示 | 查看没有 EXIF 的照片 | 显示"暂无 EXIF 数据"提示 | ✅ 正常 | |
| ISO 显示 | 查看有 ISO 的照片 | 显示 ISO 值（如 "400"） | ✅ 已修复 | 数据库同步问题已解决 |
| 光圈显示 | 查看有光圈的 EXIF | 显示格式化光圈（如 "f/2.8"） | ✅ 已修复 | 数据库同步问题已解决 |
| 快门显示 | 查看有快门的 EXIF | 显示格式化快门（如 "1/125s"） | ✅ 已修复 | 数据库同步问题已解决 |
| 焦距显示 | 查看有焦距的 EXIF | 显示格式化焦距（如 "50mm"） | ✅ 已修复 | 数据库同步问题已解决 |
| GPS 显示 | 查看有 GPS 的照片 | 显示经纬度坐标 | ✅ 已修复 | 数据库同步问题已解决 |
| 海拔显示 | 查看有海拔的 EXIF | 显示海拔（如 "50.5 m"） | ✅ 已修复 | 数据库同步问题已解决 |
| GPS 为 null | 查看没有 GPS 的照片 | GPS 项显示 "-" 或不显示 | 正常 |
| 海拔为 null | 查看没有海拔的 EXIF | 海拔项不显示 | 正常 |
| 描述显示 | 查看有描述的 EXIF | 显示描述文本 | 正常 |
| 备注显示 | 查看有备注的 EXIF | 显示备注文本 | 正常 |
| EXIF 同步状态 | 查看底部状态栏 | 显示"已同步"或"未同步" | 同步后需刷新页面才能正常显示 |
| 写入时间显示 | 查看已写入 EXIF 的照片 | 显示写入时间 | 同步后需刷新页面才能正常显示 |
| 关闭 EXIF 面板 | 再次点击"EXIF 信息"按钮 | 按钮文本变为"隐藏 EXIF"，面板关闭 | ✅ 正常 | |
| 切换照片保持面板 | 开启 EXIF 面板后切换照片 | 面板保持显示，数据更新 | ✅ 正常 | |

---

### 模块 7: EXIF 编辑功能 ✏️

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 打开编辑对话框 | 在预览中点击"编辑 EXIF"按钮 | 打开 EXIF 编辑表单 | ✅ 正常 | |
| 显示当前值 | 打开有 EXIF 的照片编辑 | 表单显示当前 EXIF 值 | ✅ 已修复 | 数据库同步问题已解决 |
| 空值处理 | 打开无 EXIF 的照片编辑 | 表单显示未设置状态 | 正常 |
| 从文件读取 EXIF | 点击"从文件读取 EXIF"按钮 | 从照片文件读取 EXIF 并填充表单 | ✅ 已修复 | ExifTool参数错误已修复 |
| 修改 ISO | 选择不同 ISO 值 | 下拉选择生效 | 同步后需刷新页面才能正常显示 |
| 修改光圈 | 选择不同光圈值 | 下拉选择生效 | 同步后需刷新页面才能正常显示 |
| 修改快门 | 选择不同快门值 | 下拉选择生效 | 同步后需刷新页面才能正常显示 |
| 修改焦距 | 选择不同焦距值 | 下拉选择生效 | 同步后需刷新页面才能正常显示 |
| 修改 GPS | 输入经纬度和海拔 | 输入框生效 | 同步后需刷新页面才能正常显示 |
| 修改描述 | 输入描述文本 | 输入框生效 | 同步后需刷新页面才能正常显示 |
| 修改备注 | 输入备注文本 | 文本域生效 | 同步后需刷新页面才能正常显示 |
| 保存到文件 | 点击"保存到文件" | 显示"保存中..."，完成后关闭对话框 | 正常 |
| 保存后刷新 | 保存后重新打开 EXIF 面板 | 显示更新后的 EXIF 值 | 正常 |
| 取消编辑 | 点击"取消"按钮 | 对话框关闭，不保存修改 | 正常 |
| 多次编辑 | 连续编辑多张照片 | 每次保存成功，数据正确 | 同步后需刷新页面才能正常显示 |

---

### 模块 8: 筛选与搜索功能 🔍

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 显示筛选器 | 查看首页 | 显示搜索框和筛选选项 | ⬜ 待测试 | |
| 搜索功能 | 在搜索框输入关键词 | 实时筛选胶卷 | ⬜ 待测试 | |
| 按胶卷型号筛选 | 选择特定胶卷型号 | 只显示该型号的胶卷 | ⬜ 待测试 | |
| 按相机筛选 | 选择特定相机 | 只显示该相机的胶卷 | ⬜ 待测试 | |
| 按日期范围筛选 | 选择开始和结束日期 | 只显示日期范围内的胶卷 | ⬜ 待测试 | |
| 只看收藏筛选 | 勾选"只看收藏" | 只显示有收藏照片的胶卷 | ⬜ 待测试 | |
| 多条件筛选 | 组合多个筛选条件 | 显示同时满足所有条件的胶卷 | ⬜ 待测试 | |
| 清除筛选 | 点击"清除筛选"按钮 | 所有筛选条件重置 | ⬜ 待测试 | |
| 筛选结果统计 | 查看结果提示文本 | 显示"找到 X 个胶卷（共 Y 个）" | ⬜ 待测试 | |
| URL 参数同步 | 筛选后复制 URL | URL 包含筛选参数 | ⬜ 待测试 | |
| URL 刷新保持 | 筛选后刷新页面 | 筛选条件保持 | ✅ 已修复 | 实施了 URL 参数同步 |

---

### 模块 9: 设置页面增强 ⚙️

| 测试项 | 测试步骤 | 预期结果 | 状态 | 备注 |
|--------|---------|---------|------|------|
| 打开设置对话框 | 点击设置图标 | 打开设置对话框 | ⬜ 待测试 | |
| EXIF 状态检查 | 查看 EXIF 设置区域 | 显示 ExifTool 可用/不可用/检查中 | ⬜ 待测试 | |
| 自动写入开关 | 切换"自动写入 EXIF" | 开关状态切换 | ⬜ 待测试 | |
| 并发写入数调整 | 拖动并发写入数滑块 | 数值变化（1-8） | ⬜ 待测试 | |
| 网格列数调整 | 拖动网格列数滑块 | 数值变化（2-6） | ✅ 已移除 | 已按用户要求移除此功能 |
| 禁用选项 | ExifTool 不可用时 | EXIF 相关选项禁用 | ⬜ 待测试 | |
| 保存设置 | 点击"保存"按钮 | 设置保存，对话框关闭 | ✅ 已修复 | 使用 React Query 管理配置 |
| 取消编辑 | 点击"取消"按钮 | 对话框关闭，不保存 | ⬜ 待测试 | |

---

### 模块 10: 收藏功能 ❤️

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 收藏照片 | 点击照片右下角红心 | 变为红色实心，已收藏 | 正常 |
| 取消收藏 | 再次点击红心 | 变为空心，未收藏 | 正常 |
| 预览对话框收藏 | 在预览中点击收藏按钮 | 状态同步更新 | 正常 |

---

### 模块 11: 删除功能 🗑️

| 测试项 | 测试步骤 | 预期结果 | 状态 |
|--------|---------|---------|------|
| 批量删除照片 | 选择多张 → 删除 | 数据库+文件被删除 | 正常 |
| 删除后刷新 | 删除后查看列表 | 照片从列表中移除 | 正常 |
| 批量删除胶卷 | 选择多个胶卷 → 删除 | 数据库+文件夹被删除 | 正常 |
| 删除最后一个胶卷 | 删除列表中最后一个胶卷 | 显示"还没有胶卷"空状态 | 正常 |

---

## 🐛 问题记录

### 问题 1: _____________
- **模块**: _____________
- **严重程度**: 🔴高 / 🟡中 / 🟢低
- **问题描述**: _____________
- **复现步骤**:
  1. _____________
  2. _____________
- **最终修复**: _____________

### 问题 2: _____________
- **模块**: _____________
- **严重程度**: 🔴高 / 🟡中 / 🟢低
- **问题描述**: _____________
- **复现步骤**:
  1. _____________
  2. _____________
- **最终修复**: _____________

### 问题 3: _____________
- **模块**: _____________
- **严重程度**: 🔴高 / 🟡中 / 🟢低
- **问题描述**: _____________
- **复现步骤**:
  1. _____________
  2. _____________
- **最终修复**: _____________

---

## 📊 测试统计

### 总体统计
- **总用例数**: __
- **通过数**: __
- **失败数**: __
- **阻塞数**: __
- **通过率**: ___%

### 模块统计
| 模块 | 总数 | 通过 | 失败 | 阻塞 | 通过率 |
|------|-----|------|------|------|--------|
| 基础设置 | 4 | __ | __ | __ | ___% |
| 导入功能 | 4 | __ | __ | __ | ___% |
| 胶卷列表 | 3 | __ | __ | __ | ___% |
| 详情页 | 3 | __ | __ | __ | ___% |
| 照片预览 | 6 | __ | __ | __ | ___% |
| EXIF 显示 | 13 | __ | __ | __ | ___% |
| EXIF 编辑 | 12 | __ | __ | __ | ___% |
| 筛选搜索 | 10 | __ | __ | __ | ___% |
| 设置页面 | 7 | __ | __ | __ | ___% |
| 收藏功能 | 3 | __ | __ | __ | ___% |
| 删除功能 | 4 | __ | __ | __ | ___% |
| **总计** | **69** | **__** | **__** | **__** | **___%** |

---

## ✨ 体验优化

001. 照片大图下设置封面图片"set as cover"按钮，点击后和点击前无状态变化，但实际已经设置成功，重新进入后才能显示"cover photo"。——✅ 已解决

002. 在详情页删除已设置封面的图片，会导致该胶卷缺少封面，删除后可让封面改为默认第一张图片。——✅ 已解决

003. 设置界面"存储库路径"设置框中仍没有显示当前图库位置，仍未解决此问题，目前设置了位置后默认显示的仍然不是路径，第二次进入app后显示的是"默认位置（应用数据目录）"，请显示数据库的路径！！！路径！！！——✅ 已解决（使用 React Query 管理配置，自动同步）

004. 去除海拔的exif，不需要海拔。——✅ 已解决（移除海拔显示和编辑）

005. 我认为现在文件级别的exif相关功能做的很傻逼，首先需要同步文件，其次需要同步和刷新，很容易出错，那么不如不采用数据库和exif信息双向同步的方案，改为前端展示的信息直接读取exif信息，所有信息也直接写入exif，这样还能简化数据库结构。——✅ 已解决（实施混合架构）

006. 网格列数调整功能不需要了。——✅ 已解决（移除相关代码）

007. 筛选后刷新页面丢失筛选条件。——✅ 已解决（实施 URL 参数同步）



---

## 📝 测试备注

### 测试过程中需要注意：
1. EXIF 相关功能需要安装 ExifTool 才能完整测试
2. 每个功能都要测试正常流程和异常流程
3. 删除操作要慎重，确保有备份或测试数据
4. 记录详细的复现步骤
5. 截图保存重要错误信息

### 测试数据准备：
- [ ] 准备测试文件夹（包含各种格式图片）
- [ ] 准备有 EXIF 的照片文件
- [ ] 准备没有 EXIF 的照片文件
- [ ] 准备空文件夹
- [ ] 准备非图片文件夹

---

## ✅ 测试完成检查

- [ ] 所有测试用例执行完毕
- [ ] 所有发现问题已修复
- [ ] EXIF 功能完整测试
- [ ] 筛选功能完整测试
- [ ] 性能指标达标
- [ ] 可以发布 v0.3.0

**测试完成时间**: _____________
**版本**: v0.3.0

---

## 🎯 性能指标

### 目标指标

| 指标 | 目标值 | 实际值 | 状态 |
|------|--------|--------|------|
| EXIF 读取 | <50ms | _____ms | ⬜ 待测试 |
| EXIF 写入 | <100ms | _____ms | ⬜ 待测试 |
| 筛选查询 | <100ms | _____ms | ⬜ 待测试 |
| 搜索响应 | <300ms | _____ms | ⬜ 待测试 |
| 应用启动 | <5s | _____s | ⬜ 待测试 |

---

**使用说明**:
- 在测试过程中实时更新此文档
- 使用快速记录模板记录问题
- 测试完成后统计总体情况
- 发现问题立即沟通，及时修复
- 体验优化区域在测试过程中填写建议
